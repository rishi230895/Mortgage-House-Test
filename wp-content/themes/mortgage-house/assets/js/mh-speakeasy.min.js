/**
 * Minified by jsDelivr using UglifyJS v3.1.10.
 * Original file: /npm/speakeasy@2.0.0/index.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var base32=require("base32.js"),crypto=require("crypto"),url=require("url"),util=require("util");exports.digest=function(e){var t,r=e.secret,o=e.counter,a=e.encoding||"ascii",n=(e.algorithm||"sha1").toLowerCase();null!=e.key&&(console.warn("Speakeasy - Deprecation Notice - Specifying the secret using `key` is no longer supported. Use `secret` instead."),r=e.key),Buffer.isBuffer(r)||(r="base32"===a?base32.decode(r):new Buffer(r,a));var s=new Buffer(8),i=o;for(t=0;t<8;t++)s[7-t]=255&i,i>>=8;var c=crypto.createHmac(n,r);return c.update(s),c.digest()},exports.hotp=function(e){var t=(null!=e.digits?e.digits:e.length)||6;null!=e.length&&console.warn("Speakeasy - Deprecation Notice - Specifying token digits using `length` is no longer supported. Use `digits` instead.");var r=e.digest||exports.digest(e),o=15&r[r.length-1],a=(127&r[o])<<24|(255&r[o+1])<<16|(255&r[o+2])<<8|255&r[o+3];return(a=new Array(t+1).join("0")+a.toString(10)).substr(-t)},exports.counter=exports.hotp,exports.hotp.verifyDelta=function(e){var t;e=Object.create(e);var r=String(e.token),o=parseInt(e.digits,10)||6,a=parseInt(e.window,10)||0,n=parseInt(e.counter,10)||0;if(r.length===o&&(r=parseInt(r,10),!isNaN(r)))for(t=n;t<=n+a;++t)if(e.counter=t,parseInt(exports.hotp(e),10)===r)return{delta:t-n}},exports.hotp.verify=function(e){return null!=exports.hotp.verifyDelta(e)},exports._counter=function(e){var t=e.step||30,r=null!=e.time?1e3*e.time:Date.now(),o=(null!=e.epoch?1e3*e.epoch:1e3*e.initial_time)||0;return null!=e.initial_time&&console.warn("Speakeasy - Deprecation Notice - Specifying the epoch using `initial_time` is no longer supported. Use `epoch` instead."),Math.floor((r-o)/t/1e3)},exports.totp=function(e){return null==(e=Object.create(e)).counter&&(e.counter=exports._counter(e)),this.hotp(e)},exports.time=exports.totp,exports.totp.verifyDelta=function(e){e=Object.create(e);var t=parseInt(e.window,10)||0;null==e.counter&&(e.counter=exports._counter(e)),e.counter-=t,e.window+=t;var r=exports.hotp.verifyDelta(e);return r&&(r.delta-=t),r},exports.totp.verify=function(e){return null!=exports.totp.verifyDelta(e)},exports.generateSecret=function(e){e||(e={});var t=e.length||32,r=encodeURIComponent(e.name||"SecretKey"),o=e.qr_codes||!1,a=e.google_auth_qr||!1,n=null==e.otpauth_url||e.otpauth_url,s=!0;void 0!==e.symbols&&!1===e.symbols&&(s=!1);var i=this.generateSecretASCII(t,s),c={};return c.ascii=i,c.hex=Buffer(i,"ascii").toString("hex"),c.base32=base32.encode(Buffer(i)).toString().replace(/=/g,""),o&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() QR codes are deprecated and no longer supported. Please use your own QR code implementation."),c.qr_code_ascii="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(c.ascii),c.qr_code_hex="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(c.hex),c.qr_code_base32="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(c.base32)),n&&(c.otpauth_url=exports.otpauthURL({secret:c.ascii,label:r})),a&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() Google Auth QR code is deprecated and no longer supported. Please use your own QR code implementation."),c.google_auth_qr="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(exports.otpauthURL({secret:c.base32,label:r}))),c},exports.generate_key=util.deprecate(function(e){return exports.generateSecret(e)},"Speakeasy - Deprecation Notice - `generate_key()` is depreciated, please use `generateSecret()` instead."),exports.generateSecretASCII=function(e,t){var r=crypto.randomBytes(e||32),o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";t&&(o+="!@#$%^&*()<>?/[]{},.:;");for(var a="",n=0,s=r.length;n<s;n++)a+=o[Math.floor(r[n]/255*(o.length-1))];return a},exports.generate_key_ascii=util.deprecate(function(e,t){return exports.generateSecretASCII(e,t)},"Speakeasy - Deprecation Notice - `generate_key_ascii()` is depreciated, please use `generateSecretASCII()` instead."),exports.otpauthURL=function(e){var t=e.secret,r=e.label,o=e.issuer,a=(e.type||"totp").toLowerCase(),n=e.counter,s=e.algorithm,i=e.digits,c=e.period,p=e.encoding||"ascii";switch(a){case"totp":case"hotp":break;default:throw new Error("Speakeasy - otpauthURL - Invalid type `"+a+"`; must be `hotp` or `totp`")}if(!t)throw new Error("Speakeasy - otpauthURL - Missing secret");if(!r)throw new Error("Speakeasy - otpauthURL - Missing label");if("hotp"===a&&(null===n||void 0===n))throw new Error("Speakeasy - otpauthURL - Missing counter value for HOTP");"base32"!==p&&(t=new Buffer(t,p)),Buffer.isBuffer(t)&&(t=base32.encode(t));var l={secret:t};if(o&&(l.issuer=o),null!=s){switch(s.toUpperCase()){case"SHA1":case"SHA256":case"SHA512":break;default:console.warn("Speakeasy - otpauthURL - Warning - Algorithm generally should be SHA1, SHA256, or SHA512")}l.algorithm=s.toUpperCase()}if(null!=i){if(isNaN(i))throw new Error("Speakeasy - otpauthURL - Invalid digits `"+i+"`");switch(parseInt(i,10)){case 6:case 8:break;default:console.warn("Speakeasy - otpauthURL - Warning - Digits generally should be either 6 or 8")}l.digits=i}if(null!=c){if(~~(c=parseInt(c,10))!==c)throw new Error("Speakeasy - otpauthURL - Invalid period `"+c+"`");l.period=c}return url.format({protocol:"otpauth",slashes:!0,hostname:a,pathname:r,query:l})};
//# sourceMappingURL=/sm/ebe35f741675b5d738bf990946cf5f4226ee4ea4828ee4f7ac098cb3b75df768.map